<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>视频播放器</title>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css"/>
    <style>
        /* CSS 代码保持不变 */
        body {
font-family: Arial, sans-serif;
margin: 0;
padding: 0;
height: 100vh;
}
.video-container {
width: 100vw;
height: 100vh;
display: flex;
align-items: center;
justify-content: center;
position: fixed; /* 使用 fixed 定位，保持在页面固定位置 */
top: 0;
left: 0;
background: black;
transition: opacity 0.5s ease; /* 添加淡出效果 */
overflow: hidden;
}
video {
width: 100%;
height: 100%;
object-fit: cover;
}
.video-controls {
position: absolute;
bottom: 10px;
left: 10px;
display: flex;
align-items: center;
}
.video-controls button {
background: transparent;
border: none;
color: white;
font-size: 16px;
cursor: pointer;
}
.video-info {
position: absolute;
top: 10px;
left: 10px;
color: white;
}
.swiper-container {
width: 100%;
height: 100%;
}
.swiper-slide {
display: flex;
align-items: center;
justify-content: center;
}
    </style>
</head>
<body>
    <div class="video-container">
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <!-- 这里会动态添加视频 -->
            </div>
            <div class="swiper-pagination"></div> 
        </div>
        <div class="video-controls">
            <button id="playButton">播放</button>
            <button id="volumeButton">取消静音</button>
        </div>
        <div class="video-info" id="videoInfo"></div>
    </div>

   <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        // 加载状态标识
        let isLoading = false;
        // 播放按钮
        let playButton = document.getElementById('playButton');
        // 音量按钮
        let volumeButton = document.getElementById('volumeButton');
        // 视频信息显示区域
        let videoInfo = document.getElementById('videoInfo');
        // Swiper 容器
        let swiperContainer = document.querySelector('.swiper-container');
        // Swiper 实例
        let swiper = null;

        // 初始化播放按钮
        function initPlayButton() {
            let currentVideo = swiper.slides[swiper.activeIndex].querySelector('video');
            if (currentVideo.paused) {
                playButton.textContent = '播放';
            } else {
                playButton.textContent = '暂停';
            }
            playButton.removeEventListener('click', playButton.clickHandler);
            playButton.clickHandler = () => {
                if (currentVideo.paused) {
                    currentVideo.play();
                    playButton.textContent = '暂停';
                } else {
                    currentVideo.pause();
                    playButton.textContent = '播放';
                }
            };
            playButton.addEventListener('click', playButton.clickHandler);
        }

        // 初始化音量按钮
        function initVolumeButton() {
            let currentVideo = swiper.slides[swiper.activeIndex].querySelector('video');
            volumeButton.textContent = currentVideo.muted ? '取消静音' : '静音';
            volumeButton.removeEventListener('click', volumeButton.clickHandler);
            volumeButton.clickHandler = () => {
                currentVideo.muted = !currentVideo.muted;
                volumeButton.textContent = currentVideo.muted ? '取消静音' : '静音';
            };
            volumeButton.addEventListener('click', volumeButton.clickHandler);
        }

        // 加载视频
        function loadVideos() {
            if (isLoading) return;
            isLoading = true;

            fetch(`https://api.kuleu.com/api/xjj?type=json`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('网络请求失败');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.code === 200) {
                        let swiperWrapper = swiperContainer.querySelector('.swiper-wrapper');
                        swiperWrapper.innerHTML = ''; // 清空之前的内容

                        // 创建新的视频 slide
                        data.videos.forEach(videoData => {
                            let videoSlide = document.createElement('div');
                            videoSlide.classList.add('swiper-slide');
                            let videoElement = document.createElement('video');
                            videoElement.src = videoData.video;
                            videoElement.controls = true;
                            videoElement.muted = false;
                            videoSlide.appendChild(videoElement);
                            swiperWrapper.appendChild(videoSlide);
                        });

                        // 初始化 Swiper 实例
                        if (swiper) {
                            swiper.destroy(true, true); // 销毁之前的实例
                        }
                        swiper = new Swiper('.swiper-container', {
                            slidesPerView: 1,
                            spaceBetween: 10,
                            speed: 500,
                            loop: true,
                            pagination: {
                                el: '.swiper-pagination',
                                clickable: true
                            },
                            on: {
                                init: () => {
                                    initPlayButton();
                                    initVolumeButton();
                                },
                                slideChange: () => {
                                    initPlayButton();
                                    initVolumeButton();
                                    // 更新视频信息
                                    let currentVideo = swiper.slides[swiper.activeIndex].querySelector('video');
                                    videoInfo.textContent = `标题：${currentVideo.dataset.title} 作者：${currentVideo.dataset.author}`;
                                }
                            }
                        });

                        isLoading = false;
                    } else {
                        showError('视频加载失败，请稍后重试');
                        isLoading = false;
                    }
                })
                .catch(error => {
                    console.error('获取视频失败:', error);
                    showError('网络错误，请检查网络连接');
                    isLoading = false;
                });
        }

        // 显示错误信息
        function showError(message) {
            alert(message);
            // 也可以使用其他方式，例如弹出一个错误提示框
        }

        // 初始化加载
        loadVideos();
    </script>
</body>
</html>
